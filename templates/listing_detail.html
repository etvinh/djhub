{% extends "base.html" %}
{% block title %}Listing · DJHub{% endblock %}

{% block content %}
<div style="max-width: 780px; margin: 24px auto; padding: 0 16px;">
  <a href="{{ url_for('listings_feed') }}" style="display:inline-block;margin-bottom:16px;color:#2563eb;text-decoration:none;">
    ← Back to feed
  </a>

  <div style="padding:16px;border:1px solid #e5e7eb;border-radius:16px;background:#fff;">
    <h1 style="margin:0 0 8px 0;">{{ listing.title }}</h1>

    <div style="color:#6b7280; display:flex; flex-wrap:wrap; gap:10px; margin-top:6px;">
      {% if listing.date %}<span><strong>Date:</strong> {{ listing.date.strftime("%b %d, %Y") }}</span>{% endif %}
      {% if listing.city %}<span><strong>Location:</strong> {{ listing.city }}</span>{% endif %}
      {% if listing.budget %}<span><strong>Budget:</strong> ${{ listing.budget }}</span>{% endif %}
      {% if listing.genres %}<span><strong>Genre:</strong> {{ listing.genres }}</span>{% endif %}
    </div>

    {% if listing.description %}
      <div style="margin-top:16px;">
        <h3 style="margin:0 0 8px 0;">Details</h3>
        <div style="white-space:pre-wrap; color:#111827;">{{ listing.description }}</div>
      </div>
    {% endif %}

    {% from "_message_box.html" import message_box with context %}

    <div style="margin-top:16px;padding-top:14px;border-top:1px solid #e5e7eb;">
      {% if listing.profile %}
        <p style="margin:0;color:#6b7280;">
          Posted by
          <a href="{{ url_for('profile_detail', profile_id=listing.profile.id) }}"
             style="color:#2563eb;text-decoration:none;font-weight:800;">
            {{ listing.profile.display_name }}
          </a>
        </p>

        {% if current_user.is_authenticated and current_user.id != listing.profile.user_id %}
          <div style="margin-top:12px;">
            {{ message_box(listing.profile.user_id) }}
          </div>
        {% endif %}
      {% else %}
        <p style="margin:0;color:#6b7280;">Posted by DJHub</p>
      {% endif %}
    </div>

  </div>
</div>
{% endblock %}
