{% extends "base.html" %}
{% block title %}My Profile Â· DJHub{% endblock %}

{% block content %}
<style>
  .profile-edit{
    max-width: 820px;
    margin: 32px auto;
    padding: 0 16px 60px;
  }
  .profile-card{
    background: #fff;
    border-radius: 18px;
    padding: 20px;
    border: 1px solid #e2e8f0;
    box-shadow: 0 12px 30px rgba(15,23,42,0.08);
  }
  .profile-card h1{
    margin: 0 0 6px 0;
    font-size: 26px;
    font-weight: 900;
    color: #0f172a;
  }
  .profile-card p{
    margin: 0 0 18px 0;
    color: #64748b;
    font-weight: 700;
  }
  .form-grid{
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 14px;
  }
  .field{
    display:flex;
    flex-direction:column;
    gap: 6px;
  }
  .field label{
    font-size: 12px;
    font-weight: 900;
    color: #0f172a;
    text-transform: uppercase;
    letter-spacing: 0.08em;
  }
  .field input,
  .field select,
  .field textarea{
    border-radius: 12px;
    border: 1px solid #cbd5f5;
    padding: 10px 12px;
    font-size: 14px;
    font-weight: 600;
    color: #0f172a;
  }
  .field textarea{
    min-height: 120px;
    resize: vertical;
  }
  .full{
    grid-column: 1 / -1;
  }
  .actions{
    margin-top: 16px;
    display:flex;
    align-items:center;
    gap: 12px;
  }
  .primary-btn{
    height: 44px;
    padding: 0 16px;
    border-radius: 12px;
    border: 0;
    background: #0b5fff;
    color: #fff;
    font-weight: 900;
    cursor: pointer;
  }
  .ghost-link{
    color: #2563eb;
    font-weight: 800;
    text-decoration: none;
  }
  @media (max-width: 720px){
    .form-grid{ grid-template-columns: 1fr; }
  }
</style>

<div class="profile-edit">
  <div class="profile-card">
    <h1>My profile</h1>
    <p>Update how DJs and planners see you on DJHub.</p>

    <form method="POST" action="{{ url_for('my_profile') }}" enctype="multipart/form-data">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <div class="form-grid">
        <div class="field">
          <label for="username">Username</label>
          <input
            id="username"
            type="text"
            value="@{{ current_user.username }}"
            disabled
          >
        </div>
        <div class="field">
          <label for="city">City</label>
          <select id="city" name="city">
            <option value="" {% if not form.get('city') and not (profile and profile.city) %}selected{% endif %}>Select location</option>
            {% for loc in locations %}
              <option value="{{ loc.name }}"
                {% if form.get('city') == loc.name or (not form.get('city') and profile and profile.city == loc.name) %}selected{% endif %}>
                {{ loc.name }}
              </option>
            {% endfor %}
          </select>
        </div>
        <div class="field">
          <label for="genres">Genres</label>
          <select id="genres" name="genres">
            <option value="" {% if not form.get('genres') and not (profile and profile.genres) %}selected{% endif %}>Select genre</option>
            {% for g in genres %}
              <option value="{{ g.name }}"
                {% if form.get('genres') == g.name or (not form.get('genres') and profile and profile.genres == g.name) %}selected{% endif %}>
                {{ g.name }}
              </option>
            {% endfor %}
          </select>
        </div>
        <div class="field">
          <label for="avatar_file">Upload avatar</label>
          <input id="avatar_file" name="avatar_file" type="file" accept="image/*">
        </div>
        <div class="field full">
          <label for="track_files">Top tracks (up to 3)</label>
          <input id="track_files" name="track_files" type="file" accept="audio/*" multiple>
        </div>
        <div class="field">
          <label for="instagram_url">Instagram URL</label>
          <input
            id="instagram_url"
            name="instagram_url"
            type="url"
            placeholder="https://instagram.com/yourname"
            value="{{ form.get('instagram_url', (profile.instagram_url or '') if profile else '') }}"
          >
        </div>
        <div class="field">
          <label for="spotify_url">Spotify URL</label>
          <input
            id="spotify_url"
            name="spotify_url"
            type="url"
            placeholder="https://open.spotify.com/artist/..."
            value="{{ form.get('spotify_url', (profile.spotify_url or '') if profile else '') }}"
          >
        </div>
        <div class="field full">
          <label for="bio">Bio</label>
          <textarea id="bio" name="bio">{{ form.get('bio', profile.bio if profile else '') }}</textarea>
        </div>
      </div>
      <div class="actions">
        <button type="submit" class="primary-btn">Save profile</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
