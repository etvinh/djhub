{% extends "base.html" %}
{% block title %}Create Listing Â· DJHub{% endblock %}

{% block content %}
<style>
  :root{
    --card: rgba(26,12,55,0.92);
    --muted: rgba(226,232,240,0.72);
    --border: rgba(255,255,255,0.12);
    --shadow: 0 18px 50px rgba(9,6,23,0.35);
    --purple: #6c4bff;
  }
  .detail-page{
    max-width: 880px;
    margin: 24px auto 80px;
    padding: 0 16px;
    color: var(--text);
  }
  .detail-card{
    padding: 18px;
    border-radius: 18px;
    background: var(--card);
    border: 1px solid var(--border);
    box-shadow: var(--shadow);
  }
  .detail-title{
    margin: 0 0 8px 0;
    font-size: 24px;
    font-weight: 900;
  }
  .detail-meta{
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 10px;
    margin-top: 10px;
  }
  .detail-section{
    margin-top: 16px;
    padding-top: 14px;
    border-top: 1px solid rgba(255,255,255,0.10);
  }
  .section-title{
    margin: 0 0 8px 0;
    font-size: 12px;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    font-weight: 900;
    color: #e5e7eb;
  }
  .field-label{
    display:block;
    margin-bottom: 6px;
    font-size: 11px;
    font-weight: 900;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    color: var(--muted);
  }
  .field-input,
  .field-textarea,
  .field-select{
    width: 100%;
    border-radius: 12px;
    border: 1px solid var(--border);
    background: rgba(255,255,255,0.10);
    color: var(--text);
    padding: 10px 12px;
    font-size: 14px;
    font-weight: 700;
    outline: none;
    appearance: none;
  }
  .field-textarea{
    min-height: 140px;
    resize: vertical;
  }
  .field-input:focus,
  .field-textarea:focus,
  .field-select:focus{
    border-color: rgba(108,75,255,0.7);
    box-shadow: 0 0 0 4px rgba(108,75,255,0.25);
    background: rgba(255,255,255,0.14);
  }
  .detail-actions{
    margin-top: 16px;
    display:flex;
    gap: 10px;
    flex-wrap: wrap;
  }
  .booking-btn{
    height: 36px;
    padding: 0 14px;
    border-radius: 999px;
    border: 0;
    background: var(--purple);
    color: #fff;
    font-weight: 800;
    cursor: pointer;
  }
  .booking-btn.secondary{
    background: rgba(255,255,255,0.12);
    color: #fff;
    border: 1px solid rgba(255,255,255,0.16);
  }
</style>

<div class="detail-page">
  <div class="detail-card">
    <form method="POST" action="{{ action_url or url_for('create_listing') }}" enctype="multipart/form-data">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

      <h1 class="detail-title">
        <input
          type="text"
          id="title"
          name="title"
          class="field-input"
          placeholder="Listing title"
          value="{{ form.get('title','') }}"
          required
          autofocus
        >
      </h1>

      <div class="detail-meta">
        <div>
          <label class="field-label" for="date">Date</label>
          <input
            type="date"
            id="date"
            name="date"
            class="field-input"
            value="{{ form.get('date','') }}"
          >
        </div>
        <div>
          <label class="field-label" for="time">Time</label>
          <input
            type="text"
            id="time"
            name="time"
            class="field-input"
            placeholder="8:30 PM"
            value="{{ form.get('time','') }}"
          >
        </div>
        <div>
          <label class="field-label" for="location">Location</label>
          <select id="location" name="location" class="field-select" required>
            <option value="" disabled {% if not form.get('location') %}selected{% endif %}>Select location</option>
            {% for loc in locations %}
              <option value="{{ loc.name }}" {% if form.get('location') == loc.name %}selected{% endif %}>
                {{ loc.name }}
              </option>
            {% endfor %}
          </select>
        </div>
        <div>
          <label class="field-label" for="budget">Budget</label>
          <input
            type="number"
            id="budget"
            name="budget"
            class="field-input"
            min="0"
            step="1"
            inputmode="numeric"
            placeholder="500"
            value="{{ form.get('budget','') }}"
          >
        </div>
        <div>
          <label class="field-label" for="genre">Genre</label>
          <select id="genre" name="genre" class="field-select" required>
            <option value="" disabled {% if not form.get('genre') %}selected{% endif %}>Select genre</option>
            {% for g in genres %}
              <option value="{{ g.name }}" {% if form.get('genre') == g.name %}selected{% endif %}>
                {{ g.name }}
              </option>
            {% endfor %}
          </select>
        </div>
      </div>

      <div class="detail-section">
        <h3 class="section-title">Details</h3>
        <textarea
          id="description"
          name="description"
          class="field-textarea"
          placeholder="Tell DJs about the event, vibe, and requirements."
        >{{ form.get('description','') }}</textarea>
      </div>

      <div class="detail-section">
        <h3 class="section-title">Media</h3>
        <div style="display:grid;gap:12px;grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));">
          <div>
            <label class="field-label" for="flyer_file">Flyer image (shows in feed)</label>
            <input
              type="file"
              id="flyer_file"
              name="flyer_file"
              class="field-input"
              accept="image/*"
            >
          </div>
          <div>
            <label class="field-label" for="photos">Additional photos</label>
            <input
              type="file"
              id="photos"
              name="photos"
              class="field-input"
              accept="image/*"
              multiple
            >
            <div style="margin-top:6px;color:var(--muted);font-weight:700;font-size:12px;">
              Use extra shots for the listing detail page. Max 5 photos.
            </div>
          </div>
        </div>
      </div>

      <div class="detail-actions">
        <button type="submit" class="booking-btn">{{ submit_label or "Post listing" }}</button>
        <a href="{{ url_for('listings_feed') }}" class="booking-btn secondary">Cancel</a>
      </div>
    </form>
  </div>
</div>
{% endblock %}
